[[backup]]
==  Backing Up and Restoring {nxrm}
{inall}

TBD

[[backup-introduction]]
=== Introduction

TBD

[[backup-configuration]]
=== Backup Plan

TBD
////
Checklist, self-repair tasks - TBD
////


[[backup-requirements]]
=== Requirements for Backing Up {nxrm}

TBD


[[backup-preparation]]
=== Preparing a Backup for {nxrm}

In preparation for a back up, {nxrm} provides a feature that allows you to export settings and metadata from
OrientDB to a relative location, before backing up the entire repository manager.

The common scenario is as follows:

* Configure the export backup task for OrientDB configurations
* Run the scheduled task to export OrientDB
* Store the configuration files to a relative location
* Back up the entire repository manager
* Restore the backed-up, exported files
////
Considerations:
You must back up your Nexus instance, and you should periodically test your backup.
All of Nexus except for the Orient databases can be backed up using a file system backup.
The Orient databases may have unflushed state, so it’s best to do export the .bak files  and back up
the exported files instead.
The databases have pointers to the blobs, so if you back up and restore either, you should do both.
(Otherwise you’ll have metadata that points to nonexistent blobs, or blobs that are unreachable because no
metadata describes them.)

Formalize: Before you execute a backup of your OrientDB, select a backup tool of your preference to
back your content, i.e. accesslog, components, system configuration, and security
////

[[backup-task]]
=== Configuring and Running a Database Backup Task

To configure and run a new task for database backup, review the steps in the Configuration chapter. The form
for this task includes an additional field called 'Backup location', which requires you to enter the path to a
directory where you want to store backup data, shown in <<fig-backup-task>>.

////
Note: removed the anchor/macro referencing tasks due to missing steps addressed in another ticket (bug)  
////

[[fig-backup-task]]
.Manual Database Backup Task with Directory Location 
image::figs/web/backup-task.png[scale=50]

////
expand the statement below, place it in the Preparation section
////
When the task runs it exports backup data to the directory in the file path added to the 'Backup location'
field. The directory you choose will contain +.bak+ files of the following databases:

Access log:: login and usage information among repository manager users 
Analytics:: event data and overall repository manager usage
Auditing:: a record of repository manager configuration changes as well as asset or component additions and
removals
Component:: all related data that make up components within the repository manager 
Configuration:: general adminstrative configurations such as scheduled tasks, email server configuration, etc.
Security:: all user and access rights management content

All backup files are presented in the timestamp format based on the time the task was started.

[[backup-node]]
=== Backing up a Single Node in {nxrm}

TBD
////
Distinguish single node backup from an backup for HA
////


[[backup-ha]]
=== Backing up {nxrm} in an HA Environment

TBD

[[backup-retrieve]]
=== Restoring a Database Backup

TBD
////
potentially, subtask for NEXUS-11203
////
